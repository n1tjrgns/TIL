## SPF 레코드, PTR 레코드, DKIM, White 도메인이란?



#### 메일 차단을 해결하는 3가지 방법

1. **SPF(Sender Policy Framework) 레코드 등록**

메일서버 등록제라고 불리는 이 설정 값은 메일을 이용하는 도메인에 설정하는 값이다.

발송한 메일서버의 IP와 DNS에 설정되어 있는 TXT의 IP값이 다를 경우 수신 측에서 메일을 차단하는 방식이다.

메일을 발송하는 서버의 IP와 도메인이 서로 일치하는지 인증을 하며, 인증방법으로 SPF레코드(TXT값)를 확인한다.

주로 메일주소를 위장해 스팸성 메일을 발송하는 것을 차단하기 위해 국내 주요 포탈사이트 및 기업에서 사용한다.



직접 도메인서버를 운용할 경우 해당 도메인의 설정에 신규 txt 레코드를 추가한다.

```
> nslookup
> set type = txt
> domain text = "v=spf1 ip4:xxx.xxx.xxx.xxx -all"
= 위의 지정된 IP에서 오는 메일을 제외하고는 모두 차단해라
```





2. **PTR 레코드(Reverse DNS) 등록**

PTR 레코드 정책은 도메인이 아닌 IP를 질의하여 도메인을 확인하는 정책으로, 수신측에서 메일발송 서버의 IP를 조회하여 도메인이 등록된 PTR 레코드(Pointer)값과 일치하면 정상적으로 판단하여 메일을 수신하는 역방향 질의 방식이다.

SPF 레코드 등록과 다른점은 DNS 운영업체가 아닌 ISP 업체(KT, LG, SK) 등과 같이 IP주소를 공급해준 업체에 등록을 해야한다. 





3. **화이트 도메인**

화이트 도메인은 메일이 스팸메일로 간주되어 KISA의 RBL(RealTime Black List)에 등록되는 것을 방지하기 위해, 사전에 등록된 개인이나 사업자에 한하여 국내 주요 포탈사이트로의 메일 전송을 보장해 주는 제도이다.

단, 화이트 도메인으로 등록되었다고 하더라도 이후 모니터링을 통해 스팸 메일 발송 사실이 확인되면, 조치될 수 있다.



화이트 도메인을 등록하기 위해서는 SPF 레코드가 DNS에 반드시 등록되어 있어야 한다.



**RBL 등록 방지 조치**

1. `SPF 레코드 등록 > 화이트 도메인 등록 > PTR 레코드 등록`
2. 국내의 경우 SPF 레코드가 스팸정첵에 영향력이 높고, 해외의 경우 PTR 레코드가 스팸차단의 기준이 된다



-----

**DKIM**

Gmail의 경우 DKIM(Domainkeys Identified Mail)을 사용하는데, 메일을 받는 사람 도메인이 유효성을 검사하고 메시지가 실제 보낸 도메인으로부터 발송되었는지 확인하는 프로세서이다.

DKIM과 SPF 레코드가 일치해야 발송이된다.

DKIM 서비스를 사용하면 나가는 메일 헤더에 DKIM-Signature를 추가해서 발송하게 된다.

수신측 메일 서버에서 DKIM서명이 포함된 메일을 받으면 DNS서버에서 서명을 해독할 공개키를 확인하여 받은 메일이 해당 도메인에서 발송된 것을 확인할 수 있다.

![1562118135677](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\1562118135677.png)









<https://m.blog.naver.com/PostView.nhn?blogId=hilineisp>

